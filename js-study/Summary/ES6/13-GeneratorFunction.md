# 生成器函数

通过function*定义一个生成器函数, 该函数返回一个[生成器对象](./14-Generator). 生成器函数在执行时能暂停, 后面又能从暂停处继续执行, 直到遇到return, 抛出异常以及到生成器函数体结束的位置处才停止.

## yield表达式

yield关键字用来暂停和恢复一个生成器函数. yield表达式只能用于生成器函数中, 用在其他地方, 会抛出错误. yield关键字后面的表达式的值返回给生成器的调用者, yield表达式的执行时按需要则执行, 当执行到这一行时, 才去计算yield表达式的值, 否则不会去计算. yield关键字实际返回一个IteratorResult对象, 它有两个属性, value和done. value属性是对yield表达式求值的结果, 而done是false. 表示生成器尚未完全执行完成. 一旦遇到yield表达式, 生成器将被暂停运行, 直到生成器的next()方法被调用. 每次调用生成器的next()方法时, 生成器都会恢复执行. 直到达到以下某个值: 
* yield: 导致生成器再次暂停并返回生成器的新值. 下一次调用next()时, 在yield之后紧接着的语句继续执行. 
* throw: 用于从生成器中抛出异常. 这让生成器完全停止执行, 并在调用者中继续执行, 正如通常情况下抛出异常一样. 
* 到达生成器函数的结尾: 在这种情况下, 生成器的执行结束. 并且IteratorResult给调用者返回undefined并且done为true. 
* return: 在这种情况下, 生成器的执行结束, 并将IteratorResult返回给调用者, 其值是由return语句指定的, 并且done为true. 
* 如果将参数传递给生成器的next()方法, 则该值将成为生成器当前yield操作返回的值.

## 生成器函数的执行过程

调用一个生成器函数并不会马上执行它里面的语句, 而是返回生成器的迭代器. 当这个迭代器的next()方法被首次调用时, 其内的语句才会执行, next()方法返回一个对象, 包含两个属性value和done, value是这一次生成器函数执行返回的值; done属性为布尔类型, 表示生成器后续是否还有yield语句, 即生成器函数是否已经执行完毕并返回. 生成器执行规则如下: 

* 第一次遇到yield表达式, 会暂停生成器函数的执行. 返回对象的value属性为yield表达式的值, done为false. 
* 下一次调用next方法时, 再继续往下执行, 直到遇到下一个yield表达式. 返回值同上
* 再一次调用next方法时, 再继续往下执行, 直到生成器函数中没有yield表达式. 返回值value为undefined, done为true
* 如果生成器函数中, 遇到显示的return语句, 则直接返回. 表示生成器函数执行完成, 即使后面还有yield语句也不会得到执行. 返回的对象的value就是return后面表达式的值, done为ture
* 如果在生成器函数执行过程中, 抛出了异常, 这让生成器函数完全停止执行, 并在调用者中继续执行, 正如通常情况下抛出异常一样.

## 没有yield表达式的生成器函数

生成器函数可以不用yield表达式, 这时就变成了一个单纯的暂缓执行函数. 通过调用生成器的next()方法, 此时生成器函数的函数体才会执行.



